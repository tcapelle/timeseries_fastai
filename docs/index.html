---

title: Title

keywords: fastai
sidebar: home_sidebar

summary: "summary"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/99_index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="timeseries_fastai">timeseries_fastai<a class="anchor-link" href="#timeseries_fastai">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is a port to fastai2 from this repo</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">fastai2.basics</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.data</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">timeseries_fastai.models.inception</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ucr_path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">UCR</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">load_df_ucr</span><span class="p">(</span><span class="n">ucr_path</span><span class="p">,</span> <span class="s1">&#39;Adiac&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Loading files from: /home/tc256760/.fastai/data/Univariate2018_arff/Adiac
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">stack_train_valid</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>att1</th>
      <th>att2</th>
      <th>att3</th>
      <th>att4</th>
      <th>att5</th>
      <th>att6</th>
      <th>att7</th>
      <th>att8</th>
      <th>att9</th>
      <th>att10</th>
      <th>...</th>
      <th>att169</th>
      <th>att170</th>
      <th>att171</th>
      <th>att172</th>
      <th>att173</th>
      <th>att174</th>
      <th>att175</th>
      <th>att176</th>
      <th>target</th>
      <th>valid_col</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.598007</td>
      <td>1.599439</td>
      <td>1.570529</td>
      <td>1.550474</td>
      <td>1.507371</td>
      <td>1.434341</td>
      <td>1.368986</td>
      <td>1.305294</td>
      <td>1.210305</td>
      <td>1.116653</td>
      <td>...</td>
      <td>1.217175</td>
      <td>1.312530</td>
      <td>1.402920</td>
      <td>1.481043</td>
      <td>1.521012</td>
      <td>1.564154</td>
      <td>1.570855</td>
      <td>1.592890</td>
      <td>b'22'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.701146</td>
      <td>1.670645</td>
      <td>1.618884</td>
      <td>1.546805</td>
      <td>1.475469</td>
      <td>1.391209</td>
      <td>1.305882</td>
      <td>1.237313</td>
      <td>1.153414</td>
      <td>1.069690</td>
      <td>...</td>
      <td>1.097360</td>
      <td>1.182578</td>
      <td>1.266291</td>
      <td>1.350571</td>
      <td>1.435160</td>
      <td>1.519737</td>
      <td>1.602518</td>
      <td>1.670190</td>
      <td>b'28'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.722342</td>
      <td>1.695329</td>
      <td>1.656946</td>
      <td>1.606312</td>
      <td>1.511824</td>
      <td>1.414148</td>
      <td>1.313688</td>
      <td>1.213234</td>
      <td>1.112978</td>
      <td>1.015081</td>
      <td>...</td>
      <td>1.164750</td>
      <td>1.263924</td>
      <td>1.364303</td>
      <td>1.463511</td>
      <td>1.547307</td>
      <td>1.641809</td>
      <td>1.694973</td>
      <td>1.708488</td>
      <td>b'21'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.726263</td>
      <td>1.659836</td>
      <td>1.573108</td>
      <td>1.496264</td>
      <td>1.409070</td>
      <td>1.332443</td>
      <td>1.245742</td>
      <td>1.158882</td>
      <td>1.073361</td>
      <td>0.987165</td>
      <td>...</td>
      <td>1.199608</td>
      <td>1.275380</td>
      <td>1.362258</td>
      <td>1.448567</td>
      <td>1.535131</td>
      <td>1.622158</td>
      <td>1.707838</td>
      <td>1.739027</td>
      <td>b'15'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.778976</td>
      <td>1.761203</td>
      <td>1.703084</td>
      <td>1.610572</td>
      <td>1.492088</td>
      <td>1.368654</td>
      <td>1.244761</td>
      <td>1.120900</td>
      <td>1.010762</td>
      <td>0.900168</td>
      <td>...</td>
      <td>1.285657</td>
      <td>1.408878</td>
      <td>1.507983</td>
      <td>1.623643</td>
      <td>1.713606</td>
      <td>1.766389</td>
      <td>1.783633</td>
      <td>1.758625</td>
      <td>b'2'</td>
      <td>False</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>776</th>
      <td>1.765127</td>
      <td>1.750026</td>
      <td>1.711097</td>
      <td>1.648484</td>
      <td>1.576266</td>
      <td>1.476857</td>
      <td>1.375652</td>
      <td>1.287533</td>
      <td>1.186471</td>
      <td>1.086855</td>
      <td>...</td>
      <td>1.192923</td>
      <td>1.291224</td>
      <td>1.391377</td>
      <td>1.490076</td>
      <td>1.589615</td>
      <td>1.661466</td>
      <td>1.711183</td>
      <td>1.750479</td>
      <td>b'25'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>777</th>
      <td>1.317664</td>
      <td>1.480770</td>
      <td>1.477460</td>
      <td>1.345680</td>
      <td>1.376355</td>
      <td>1.383122</td>
      <td>1.262999</td>
      <td>1.154494</td>
      <td>1.057933</td>
      <td>0.973615</td>
      <td>...</td>
      <td>1.038177</td>
      <td>0.963510</td>
      <td>1.052633</td>
      <td>1.149836</td>
      <td>1.111965</td>
      <td>1.217966</td>
      <td>1.214703</td>
      <td>1.325830</td>
      <td>b'35'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>778</th>
      <td>1.652000</td>
      <td>1.696799</td>
      <td>1.700560</td>
      <td>1.675451</td>
      <td>1.645406</td>
      <td>1.584621</td>
      <td>1.568612</td>
      <td>1.477382</td>
      <td>1.376073</td>
      <td>1.345743</td>
      <td>...</td>
      <td>1.135803</td>
      <td>1.190241</td>
      <td>1.293052</td>
      <td>1.369039</td>
      <td>1.435152</td>
      <td>1.499251</td>
      <td>1.555716</td>
      <td>1.620383</td>
      <td>b'5'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>779</th>
      <td>1.398673</td>
      <td>1.293392</td>
      <td>1.188837</td>
      <td>1.086091</td>
      <td>0.984476</td>
      <td>0.885808</td>
      <td>0.789724</td>
      <td>0.696206</td>
      <td>0.605575</td>
      <td>0.518136</td>
      <td>...</td>
      <td>1.618150</td>
      <td>1.679640</td>
      <td>1.713751</td>
      <td>1.703014</td>
      <td>1.694377</td>
      <td>1.636338</td>
      <td>1.562648</td>
      <td>1.460544</td>
      <td>b'36'</td>
      <td>True</td>
    </tr>
    <tr>
      <th>780</th>
      <td>1.727172</td>
      <td>1.728359</td>
      <td>1.693759</td>
      <td>1.642345</td>
      <td>1.582616</td>
      <td>1.515496</td>
      <td>1.403261</td>
      <td>1.287341</td>
      <td>1.168944</td>
      <td>1.048659</td>
      <td>...</td>
      <td>1.097731</td>
      <td>1.218005</td>
      <td>1.336483</td>
      <td>1.451600</td>
      <td>1.554501</td>
      <td>1.627295</td>
      <td>1.675343</td>
      <td>1.698931</td>
      <td>b'10'</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
<p>781 rows Ã— 178 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">TSDataLoaders</span><span class="o">.</span><span class="n">from_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x_cols</span><span class="o">=</span><span class="n">x_cols</span><span class="p">,</span> <span class="n">label_col</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="n">valid_col</span><span class="o">=</span><span class="s1">&#39;valid_col&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">inception</span> <span class="o">=</span> <span class="n">create_inception</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">37</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">inception</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="n">accuracy</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>(#5) [0,1.0972908735275269,1.3116531372070312,0.6086956262588501,&#39;00:01&#39;]
(#5) [1,1.0614722967147827,1.1361106634140015,0.6470588445663452,&#39;00:01&#39;]
(#5) [2,1.045316219329834,1.0613058805465698,0.6854220032691956,&#39;00:01&#39;]
(#5) [3,1.0245380401611328,1.8741352558135986,0.43989768624305725,&#39;00:01&#39;]
(#5) [4,1.0085417032241821,1.5247629880905151,0.48081842064857483,&#39;00:01&#39;]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

